{
  "ssh_activity": {
    "patterns": {
      "failed_login": [
        "Failed password",
        "Invalid user",
        "authentication failure",
        "Connection closed by authenticating user",
        "Failed publickey",
        "Did not receive identification string",
        "Bad protocol version",
        "Authentication refused"
      ],
      "successful_login": [
        "Accepted password",
        "Accepted publickey",
        "session opened for user",
        "pam_unix(sshd:session): session opened"
      ],
      "suspicious_commands": [
        "ssh -L",
        "ssh -R", 
        "ssh -D",
        "ssh -f",
        "ProxyCommand",
        "LocalForward",
        "RemoteForward",
        "DynamicForward",
        "ssh -N",
        "ssh -T",
        "ssh -o StrictHostKeyChecking=no"
      ],
      "brute_force_indicators": [
        "maximum authentication attempts exceeded",
        "too many authentication failures",
        "repeated login failures",
        "Connection reset by peer",
        "Connection timed out during banner exchange"
      ],
      "connection_anomalies": [
        "did not receive identification",
        "connection closed by authenticating user", 
        "connection reset",
        "protocol error",
        "bad protocol version",
        "protocol major versions differ",
        "received disconnect from"
      ]
    },
    "thresholds": {
      "failed_login_count": 5,
      "failed_login_window_minutes": 5,
      "brute_force_threshold": 10,
      "brute_force_window_minutes": 10
    },
    "severity_mapping": {
      "failed_login": "MEDIUM",
      "brute_force": "HIGH",
      "port_forwarding": "HIGH",
      "successful_login_after_failures": "HIGH",
      "invalid_user": "MEDIUM",
      "publickey_failure": "LOW",
      "connection_anomaly": "MEDIUM"
    }
  },
  "privilege_escalation": {
    "patterns": {
      "sudo_abuse": [
        "sudo su",
        "sudo -i", 
        "sudo /bin/bash",
        "sudo /bin/sh",
        "sudo passwd",
        "sudo visudo",
        "sudo -s",
        "sudo su -"
      ],
      "setuid_usage": [
        "chmod +s",
        "chmod 4755",
        "chmod u+s",
        "setuid",
        "chmod 2755",
        "chmod g+s",
        "find.*-perm.*4000",
        "find.*-perm.*2000"
      ],
      "dangerous_sudo": [
        "sudo rm",
        "sudo mv",
        "sudo chmod 777",
        "sudo chown",
        "sudo systemctl",
        "sudo mount",
        "sudo umount", 
        "sudo fdisk",
        "sudo dd",
        "sudo mkfs"
      ],
      "privilege_keywords": [
        "gained administrative privileges",
        "elevated to root",
        "privilege escalation",
        "became root",
        "switched to root",
        "escalated privileges"
      ],
      "suid_binaries": [
        "find.*-perm.*-4000",
        "find.*-perm.*u+s", 
        "ls -la.*rwsr",
        "stat.*4755",
        "which.*sudo",
        "locate.*suid"
      ]
    },
    "severity_mapping": {
      "sudo_to_root": "HIGH",
      "setuid_modification": "HIGH", 
      "dangerous_sudo": "MEDIUM",
      "passwd_change": "HIGH",
      "visudo_access": "HIGH",
      "suid_discovery": "MEDIUM"
    }
  },
  "account_management": {
    "patterns": {
      "user_creation": [
        "useradd",
        "adduser",
        "new user",
        "user added",
        "account created",
        "pam_unix(passwd:chauthtok): password changed"
      ],
      "user_modification": [
        "usermod",
        "passwd",
        "chage",
        "user modified",
        "chfn",
        "chsh",
        "account modified"
      ],
      "user_deletion": [
        "userdel",
        "deluser",
        "user deleted",
        "account removed",
        "account deleted"
      ],
      "group_changes": [
        "groupadd",
        "usermod -a -G",
        "gpasswd",
        "added to group",
        "groupmod",
        "groupdel",
        "group created",
        "group modified"
      ],
      "suspicious_users": [
        "nobody",
        "daemon",
        "bin",
        "sys",
        "sync",
        "games",
        "man",
        "lp",
        "mail",
        "news",
        "uucp",
        "proxy",
        "www-data",
        "backup",
        "list",
        "irc",
        "gnats",
        "guest",
        "test",
        "temp",
        "admin"
      ],
      "shadow_file_access": [
        "cat /etc/shadow",
        "less /etc/shadow",
        "vim /etc/shadow",
        "nano /etc/shadow",
        "access to /etc/shadow",
        "shadow file opened"
      ],
      "suspicious_home_locations": [
        "/tmp/",
        "/var/tmp/",
        "/dev/shm/",
        "/var/www/",
        "/usr/local/"
      ]
    },
    "severity_mapping": {
      "user_creation": "HIGH",
      "root_password_change": "HIGH",
      "group_modification": "MEDIUM",
      "suspicious_user_activity": "HIGH",
      "shadow_access": "HIGH",
      "user_deletion": "MEDIUM"
    }
  },
  "service_manipulation": {
    "patterns": {
      "service_creation": [
        "systemctl enable",
        "systemctl start",
        "service started",
        "unit file created",
        "systemctl daemon-reload",
        "Created symlink",
        "Installing to",
        "systemd.*unit.*created"
      ],
      "service_modification": [
        "systemctl stop",
        "systemctl disable", 
        "systemctl mask",
        "service stopped",
        "systemctl reload",
        "systemctl restart",
        "unit file modified",
        "systemd configuration changed"
      ],
      "service_masking": [
        "systemctl mask",
        "masked unit",
        "unit masked", 
        "Created symlink.*dev.*null",
        "unit is masked",
        "masked and disabled"
      ],
      "timer_manipulation": [
        "systemctl.*timer",
        "timer created",
        "timer enabled",
        "timer started",
        "timer stopped",
        "timer disabled",
        "OnCalendar=",
        "OnBootSec=",
        "OnUnitActiveSec=",
        "systemd timer"
      ],
      "suspicious_startup_patterns": [
        "ExecStart=/tmp/",
        "ExecStart=/var/tmp/",
        "ExecStart=/dev/shm/", 
        "User=root.*ExecStart=",
        "Type=forking.*ExecStart=.*nc",
        "WantedBy=multi-user.target.*tmp",
        "ExecStart=.*wget",
        "ExecStart=.*curl",
        "ExecStart=.*bash.*-c"
      ],
      "socket_activation": [
        "systemctl.*socket",
        "ListenStream=",
        "Accept=yes",
        "socket activated",
        "socket unit created",
        "systemd socket"
      ],
      "suspicious_services": [
        "nc",
        "netcat", 
        "telnet",
        "rsh",
        "rlogin",
        "xinetd",
        "tor",
        "i2p",
        "bitcoin",
        "monero",
        "xmrig",
        "cpuminer",
        "vnc",
        "teamviewer",
        "anydesk",
        "ngrok",
        "frp"
      ],
      "critical_services": [
        "sshd",
        "systemd-logind",
        "networking",
        "firewalld",
        "iptables",
        "fail2ban",
        "rsyslog",
        "systemd-journald",
        "auditd",
        "clamav",
        "apparmor",
        "selinux",
        "systemd-resolved",
        "systemd-networkd",
        "ufw",
        "chronyd",
        "ntp"
      ]
    },
    "thresholds": {
      "rapid_service_changes_threshold": 3,
      "rapid_service_window_minutes": 5,
      "critical_service_threshold": 2
    },
    "severity_mapping": {
      "suspicious_service_start": "HIGH",
      "critical_service_stop": "HIGH",
      "service_creation": "MEDIUM",
      "service_modification": "MEDIUM",
      "service_masking": "HIGH",
      "timer_manipulation": "HIGH",
      "socket_activation": "MEDIUM"
    }
  },
  "process_execution": {
    "patterns": {
      "suspicious_processes": [
        "nc -l",
        "ncat -l",
        "/dev/tcp/",
        "/dev/udp/",
        "bash -i",
        "sh -i",
        "python -c",
        "perl -e",
        "ruby -e",
        "php -r",
        "node -e"
      ],
      "network_tools": [
        "nmap",
        "masscan",
        "zmap",
        "hping",
        "tcpdump",
        "wireshark",
        "tshark",
        "ncat",
        "socat",
        "proxychains"
      ],
      "download_tools": [
        "wget",
        "curl",
        "fetch",
        "lynx",
        "links",
        "aria2c",
        "axel",
        "lftp"
      ],
      "reverse_shells": [
        "bash -i >& /dev/tcp/",
        "nc -e /bin/bash",
        "rm /tmp/f;mkfifo /tmp/f",
        "python.*socket.*subprocess",
        "perl.*socket.*exec",
        "ruby.*socket.*exec",
        "php.*fsockopen.*exec"
      ],
      "file_transfer": [
        "scp",
        "sftp",
        "rsync",
        "ftp",
        "tftp",
        "base64 -d",
        "uuencode",
        "uudecode"
      ],
      "persistence_commands": [
        "crontab",
        "at ",
        "systemctl --user",
        "~/.bashrc",
        "~/.profile",
        "/etc/rc.local",
        "update-rc.d"
      ]
    },
    "severity_mapping": {
      "reverse_shell": "HIGH",
      "network_scanning": "HIGH", 
      "suspicious_download": "MEDIUM",
      "interactive_shell": "MEDIUM",
      "file_transfer": "MEDIUM",
      "persistence_attempt": "HIGH"
    }
  },
  "network_connections": {
    "patterns": {
      "suspicious_outbound": [
        "connection to unknown host",
        "outbound connection established",
        "tcp connection opened",
        "connection established to",
        "outgoing connection"
      ],
      "port_scanning": [
        "port scan detected",
        "multiple connection attempts",
        "connection refused",
        "rapid connection attempts",
        "port probe detected"
      ],
      "unusual_ports": [
        ":1337",
        ":4444",
        ":31337",
        ":8080",
        ":9999",
        ":6666",
        ":1234",
        ":12345"
      ],
      "tor_indicators": [
        ":9050",
        ":9051",
        "tor proxy",
        "onion routing",
        ".onion"
      ]
    },
    "severity_mapping": {
      "suspicious_outbound": "MEDIUM",
      "port_scanning": "HIGH",
      "unusual_port_usage": "MEDIUM",
      "tor_usage": "HIGH"
    }
  },
  "filesystem_changes": {
    "patterns": {
      "critical_files": [
        "/etc/passwd",
        "/etc/shadow",
        "/etc/sudoers",
        "/etc/ssh/sshd_config",
        "/etc/hosts",
        "/etc/crontab",
        "/etc/fstab",
        "/boot/",
        "/etc/systemd/"
      ],
      "suspicious_locations": [
        "/tmp/",
        "/var/tmp/",
        "/dev/shm/",
        "/var/www/uploads/",
        "/usr/local/bin/",
        "/opt/",
        "/home/*/.ssh/",
        "/root/.ssh/"
      ],
      "executable_extensions": [
        ".sh",
        ".py",
        ".pl",
        ".rb",
        ".exe",
        ".elf",
        ".bin",
        ".so"
      ],
      "hidden_files": [
        "/.*",
        ".*rc",
        ".*profile",
        ".*history",
        ".*config"
      ]
    },
    "severity_mapping": {
      "critical_file_modification": "HIGH",
      "suspicious_file_creation": "MEDIUM",
      "executable_in_temp": "HIGH",
      "hidden_file_creation": "MEDIUM"
    }
  },
  "log_tampering": {
    "patterns": {
      "log_clearing": [
        "log cleared",
        "history cleared",
        "journal vacuum",
        "logrotate forced",
        "journalctl --vacuum",
        "> /var/log/",
        "truncate -s 0"
      ],
      "log_modification": [
        "log file modified",
        "wtmp modified",
        "lastlog modified",
        "utmp modified",
        "auth.log modified"
      ],
      "history_manipulation": [
        "history -c",
        "unset HISTFILE",
        "HISTSIZE=0",
        "rm.*bash_history",
        "rm.*zsh_history",
        "ln -sf /dev/null",
        "export HISTFILE=/dev/null"
      ]
    },
    "severity_mapping": {
      "log_clearing": "HIGH",
      "history_manipulation": "HIGH",
      "log_modification": "MEDIUM"
    }
  },
  "cron_manipulation": {
    "patterns": {
      "cron_creation": [
        "crontab installed",
        "cron job added",
        "crontab modified",
        "crontab -e",
        "crontab -u"
      ],
      "suspicious_cron": [
        "* * * * *",
        "/tmp/",
        "/var/tmp/",
        "wget",
        "curl",
        "nc ",
        "bash -c",
        "python -c"
      ],
      "systemd_timers": [
        "timer created",
        "timer enabled",
        "timer started",
        "systemctl.*timer",
        "OnCalendar="
      ]
    },
    "severity_mapping": {
      "suspicious_cron_job": "HIGH",
      "cron_modification": "MEDIUM",
      "frequent_cron": "MEDIUM",
      "systemd_timer": "HIGH"
    }
  },
  "kernel_modules": {
    "patterns": {
      "module_loading": [
        "insmod",
        "modprobe",
        "module loaded",
        "driver loaded",
        "Loading module",
        "rmmod"
      ],
      "suspicious_modules": [
        "rootkit",
        "keylogger", 
        "backdoor",
        "trojan",
        "stealth",
        "hidden"
      ],
      "unsigned_modules": [
        "unsigned module",
        "module verification failed",
        "tainted kernel",
        "module signature verification failed"
      ]
    },
    "severity_mapping": {
      "unsigned_module": "HIGH",
      "suspicious_module": "HIGH",
      "module_loading": "MEDIUM"
    }
  },
  "command_history": {
    "patterns": {
      "suspicious_commands": [
        "history -c",
        "rm -rf /",
        "dd if=/dev/zero",
        "mkfs",
        "shred",
        "wipe",
        "srm"
      ],
      "network_commands": [
        "nc",
        "netcat",
        "telnet",
        "ssh",
        "scp",
        "rsync",
        "ftp",
        "wget",
        "curl"
      ],
      "reconnaissance": [
        "ps aux",
        "netstat",
        "ss -tulpn",
        "lsof",
        "find / -name",
        "locate",
        "which",
        "whereis",
        "id",
        "whoami",
        "uname -a",
        "cat /etc/passwd"
      ],
      "privilege_commands": [
        "sudo",
        "su -",
        "passwd",
        "chmod +s",
        "chown root",
        "visudo",
        "gpasswd"
      ]
    },
    "severity_mapping": {
      "destructive_command": "HIGH",
      "history_clearing": "HIGH",
      "network_activity": "MEDIUM",
      "reconnaissance": "MEDIUM",
      "privilege_activity": "MEDIUM"
    }
  }
}
